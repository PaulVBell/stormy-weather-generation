"0",""
"0","n_eff <- function(S1,S2){"
"0","  ac <- as.numeric(acf(S1 - S2, plot = FALSE, na.action=na.pass)$acf)"
"0","  ac[abs(ac)<0.005] <- 0"
"0","  ac <- ac[1:which.min(abs(ac))]"
"0","  sum(!is.na(S1)) /(1 + 2 * sum(ac[2:length(ac)]))"
"0","}"
"0",""
"0","dm_test <- function(S1,S2){"
"0","  N <- n_eff(S1,S2)"
"0","  dm_var <- (1 / N) * sum((S1 - S2)^2, na.rm=TRUE)"
"0","  t <- (N^.5) * (mean(S1, na.rm=TRUE) - mean(S2, na.rm=TRUE)) / (dm_var^.5)"
"0","  t"
"0","}"
"0",""
"0","dm_test_no_neff <- function(S1,S2){"
"0","  N <- sum(!is.na(S1))"
"0","  dm_var <- (1 / N) * sum((S1 - S2)^2, na.rm=TRUE)"
"0","  t <- (N^.5) * (mean(S1, na.rm=TRUE) - mean(S2, na.rm=TRUE)) / (dm_var^.5)"
"0","  t"
"0","}"
